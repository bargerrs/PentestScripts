from ipaddress import ip_network, ip_address
import sys

if __name__ == "__main__":
	if (0):
		print(f"Arguments count: {len(sys.argv)}")
		for i, arg in enumerate(sys.argv):
			print(f"Argument {i:>6}: {arg}")

	if (len(sys.argv)<3):
		print ("\t************************************************")
		print ("\tUSAGE:")
		print ("\tpython scopeChecker.py <scopefile> <ipaddress>")
		print ("\t************************************************")
		sys.exit()
        
	fileName = sys.argv[1]
	ipCheck = sys.argv[2]
	found = False

	with open(fileName) as f:
		for line in f:
			net = ip_network(line.strip())
			if (ip_address(ipCheck) in net) :
				print (ipCheck + " is in subnet " + line)
				found = True
	
	if (not found):
		print ("NOT FOUND")

